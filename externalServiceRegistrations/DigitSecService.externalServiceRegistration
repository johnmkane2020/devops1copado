<?xml version="1.0" encoding="UTF-8"?>
<ExternalServiceRegistration xmlns="http://soap.sforce.com/2006/04/metadata">
    <label>DigitSecService</label>
    <namedCredential>DigitSecCredentials</namedCredential>
    <operations>
        <active>true</active>
        <name>getfindings</name>
    </operations>
    <operations>
        <active>true</active>
        <name>liststatus</name>
    </operations>
    <operations>
        <active>true</active>
        <name>loginuser</name>
    </operations>
    <operations>
        <active>true</active>
        <name>logoutuser</name>
    </operations>
    <operations>
        <active>true</active>
        <name>scancopadobranchstart</name>
    </operations>
    <operations>
        <active>true</active>
        <name>scancopadoinit</name>
    </operations>
    <operations>
        <active>true</active>
        <name>scancopadostart</name>
    </operations>
    <operations>
        <active>true</active>
        <name>scaninit</name>
    </operations>
    <operations>
        <active>true</active>
        <name>scanstart</name>
    </operations>
    <registrationProviderType>Custom</registrationProviderType>
    <schema>{
  &quot;swagger&quot;: &quot;2.0&quot;,
  &quot;info&quot;: {
    &quot;description&quot;: &quot;S4 Security Scanner for Salesforce.&quot;,
    &quot;version&quot;: &quot;Spri 2021v22&quot;,
    &quot;title&quot;: &quot;S4&quot;,
    &quot;termsOfService&quot;: &quot;https://s4.digitsec.com/terms&quot;,
    &quot;contact&quot;: {
      &quot;email&quot;: &quot;info@digitsec.com&quot;
    }
  },
  &quot;host&quot;: &quot;s4.digitsec.com&quot;,
  &quot;basePath&quot;: &quot;/&quot;,
  &quot;tags&quot;: [
    {
      &quot;name&quot;: &quot;s4&quot;,
      &quot;description&quot;: &quot;SaaS Security Scanner for Salesforce v1&quot;,
      &quot;externalDocs&quot;: {
        &quot;description&quot;: &quot;Find out more&quot;,
        &quot;url&quot;: &quot;https://s4.digitsec.com/&quot;
      }
    },
    {
      &quot;name&quot;: &quot;auth&quot;,
      &quot;description&quot;: &quot;Authentication&quot;
    },
    {
      &quot;name&quot;: &quot;scan&quot;,
      &quot;description&quot;: &quot;Scanning &quot;
    },
    {
      &quot;name&quot;: &quot;uploadcodescan&quot;,
      &quot;description&quot;: &quot;Scanning using uploaded code&quot;
    },
    {
      &quot;name&quot;: &quot;org&quot;,
      &quot;description&quot;: &quot;Salesforce organization&quot;
    }
  ],
  &quot;schemes&quot;: [
    &quot;https&quot;
  ],
  &quot;paths&quot;: {
    &quot;/api/login&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;auth&quot;
        ],
        &quot;summary&quot;: &quot;Authenticate&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;loginUser&quot;,
        &quot;consumes&quot;: [
          &quot;application/json&quot;
        ],
        &quot;produces&quot;: [
          &quot;application/json&quot;
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;Successfull authentication, and token&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/LoginResponse&quot;
            }
          }
        }
      }
    },
    &quot;/logout&quot;: {
      &quot;get&quot;: {
        &quot;tags&quot;: [
          &quot;auth&quot;
        ],
        &quot;summary&quot;: &quot;Authenticate&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;logoutUser&quot;,
        &quot;parameters&quot;: [],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;logged out&quot;
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Initialize a scan&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;scanInit&quot;,
        &quot;produces&quot;: [
          &quot;application/json&quot;
        ],
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/Org&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanResponse&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/copadoscan&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Initialize a Copado Scan&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;scanCopadoInit&quot;,
        &quot;produces&quot;: [
          &quot;application/json&quot;
        ],
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id obtained from the UserStory Credential.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/CopadoOrg&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanResponse&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan/start&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Launch a scan&quot;,
        &quot;description&quot;: &quot;Launches a security scan&quot;,
        &quot;operationId&quot;: &quot;scanStart&quot;,
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/ScanOrg&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanStartResponse&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan/copado/start&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Launch a Copado scan&quot;,
        &quot;description&quot;: &quot;Launches a security scan with Copado Environment Creds&quot;,
        &quot;operationId&quot;: &quot;scanCopadoStart&quot;,
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/ScanCopadoOrg&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanStartResponse&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan/copadobranch/start&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Launch a Copado scan&quot;,
        &quot;description&quot;: &quot;Launches a security scan with Copado Environment Creds&quot;,
        &quot;operationId&quot;: &quot;scanCopadoBranchStart&quot;,
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/ScanCopadoBranchOrg&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanOrg&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan/list/status&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Gets the list of all scans against a Salesforce org&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;listStatus&quot;,
        &quot;consumes&quot;: [
          &quot;application/json&quot;
        ],
        &quot;produces&quot;: [
          &quot;application/json&quot;
        ],
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/ScanOrg&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;:{
              &quot;$ref&quot;:&quot;#/definitions/ScanListStatusResponse&quot;
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    },
    &quot;/scan/copado/findings&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;scan&quot;
        ],
        &quot;summary&quot;: &quot;Get the findings associated with a scan&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;operationId&quot;: &quot;getFindings&quot;,
        &quot;consumes&quot;: [
          &quot;application/json&quot;
        ],
        &quot;produces&quot;: [
          &quot;application/json&quot;
        ],
        &quot;parameters&quot;: [
          {
            &quot;in&quot;: &quot;header&quot;,
            &quot;name&quot;: &quot;x-access-token&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
          },
          {
            &quot;in&quot;: &quot;body&quot;,
            &quot;name&quot;: &quot;body&quot;,
            &quot;description&quot;: &quot;Salesforce org id generated by S4.&quot;,
            &quot;required&quot;: true,
            &quot;schema&quot;: {
              &quot;$ref&quot;: &quot;#/definitions/pdfScanId&quot;
            }
          }
        ],
        &quot;responses&quot;: {
          &quot;200&quot;: {
            &quot;description&quot;: &quot;successful operation&quot;,
            &quot;schema&quot;: {
              &quot;type&quot;: &quot;object&quot;,
              &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/definitions/findingObj&quot;
              }
            }
          }
        },
        &quot;security&quot;: [
          {
            &quot;api_key&quot;: []
          }
        ]
      }
    }
  },
  &quot;securityDefinitions&quot;: {
    &quot;api_key&quot;: {
      &quot;type&quot;: &quot;apiKey&quot;,
      &quot;name&quot;: &quot;x-access-token&quot;,
      &quot;in&quot;: &quot;header&quot;
    }
  },
  &quot;definitions&quot;: {
    &quot;ScanListStatusResponse&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;status&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;autoscan&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Org_Id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Created_date&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Critical&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;High&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Medium&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Low&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Info&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ScanResponse&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;status&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;autoscan&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Org_Id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Created_date&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;LoginResponse&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;auth&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;company&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;token&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;User&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;email&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;password&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;Org&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;org_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;CopadoOrg&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;org_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;copado&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ScanOrg&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;orgId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;scanId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ScanCopadoOrg&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;orgId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;scanId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;copado&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;commit&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ScanCopadoBranchOrg&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;orgId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;scanId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;copado&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;branchscan&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;branchlink&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;commit&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;pdfScanId&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;scanId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ScanStartResponse&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;success&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;scanId&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;ErrorRes&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;error&quot;: {
          &quot;type&quot;: &quot;boolean&quot;,
          &quot;description&quot;: &quot;true&quot;
        },
        &quot;message&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;description&quot;: &quot;Error message&quot;
        }
      }
    },
    &quot;createOrgBody&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;name&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;clientid&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;instanceurl&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      }
    },
    &quot;updateRule&quot;: {
      &quot;properties&quot;: {
        &quot;rule_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;action&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        }
      }
    },
    &quot;filtersData&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;issueTypes&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;description&quot;: &quot;Array of distinct values in issue (title)&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;string&quot;
          }
        },
        &quot;assignTo&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;description&quot;: &quot;Array of distinct values in assign-to field&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;string&quot;
          }
        },
        &quot;severity&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;description&quot;: &quot;Array of distinct values in severity field&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;string&quot;
          }
        },
        &quot;status&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;description&quot;: &quot;Array of distinct values in status field&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;string&quot;
          }
        }
      }
    },
    &quot;orgObj&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;_id&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;name&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;instanceurl&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;Created_date&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;format&quot;: &quot;date&quot;
        },
        &quot;Last_scanned&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;format&quot;: &quot;date&quot;
        },
        &quot;isActive&quot;: {
          &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;status&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;string&quot;
          }
        },
        &quot;scanrules&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {}
          }
        },
        &quot;codeanalysis&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {}
          }
        },
        &quot;runtimeanalysis&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {}
          }
        },
        &quot;configanalysis&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {}
          }
        }
      }
    },
    &quot;findingObj&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;findings&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;items&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {}
          }
        }
    }
  }
}</schema>
    <schemaType>OpenApi</schemaType>
    <serviceBinding>{&quot;compatibleMediaTypes&quot;:{}}</serviceBinding>
    <status>Complete</status>
    <systemVersion>2</systemVersion>
</ExternalServiceRegistration>
